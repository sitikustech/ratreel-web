var B=Object.defineProperty;var A=t=>{throw TypeError(t)};var T=(t,i,e)=>i in t?B(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var v=(t,i,e)=>T(t,typeof i!="symbol"?i+"":i,e),L=(t,i,e)=>i.has(t)||A("Cannot "+e);var c=(t,i,e)=>(L(t,i,"read from private field"),e?e.call(t):i.get(t)),f=(t,i,e)=>i.has(t)?A("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(t):i.set(t,e),E=(t,i,e,n)=>(L(t,i,"write to private field"),n?n.call(t,e):i.set(t,e),e),C=(t,i,e)=>(L(t,i,"access private method"),e);import{f as g,F,U as P,c as U,a as b,P as W,M,W as $}from"./index-DQ-9F6AZ.js";/**
 * @license lucide v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2"}]],N=()=>{const t=document.createElement("div"),i=document.createElement("div");i.setAttribute("id","drop-area"),i.addEventListener("dragenter",s),i.addEventListener("dragover",s),i.addEventListener("dragleave",o),i.addEventListener("drop",a=>{o(a),r(a)},!1);const e=document.createElement("p");e.classList.add("text"),e.textContent="Drag & drop files here or";const n=document.createElement("label");n.setAttribute("for","file-input"),n.classList.add("text-label"),n.textContent="click to select",e.appendChild(n);const l=document.createElement("input");l.setAttribute("type","file"),l.setAttribute("id","file-input"),l.setAttribute("multiple","true"),l.addEventListener("change",()=>D(l.files),!1),i.appendChild(e),i.appendChild(l);const d=document.createElement("div");d.setAttribute("id","file-list"),t.appendChild(i),t.appendChild(d);function s(a){a.preventDefault(),a.stopPropagation(),i.classList.add("highlight")}function o(a){a.preventDefault(),a.stopPropagation(),i.classList.remove("highlight")}function r(a){const y=a.dataTransfer.files;D(y)}return t};function D(t){const i=Array.from(t).filter(e=>R(e));if(i.length===0){alert("No valid files selected.");return}i.forEach(e=>{V(e).then(n=>{S(n.data,n.pk.toString())})})}function R(t){return console.log(t.type),["image/jpeg","image/png","image/gif","video/mp4","video/mov","video/x-m4v","audio/mpeg","audio/wav"].includes(t.type)}function S(t,i){const e=document.createElement("button"),n=`file-item-${i}`;if(e.setAttribute("id",n),e.setAttribute("tabindex","0"),e.setAttribute("title",t.metadata.filename),e.setAttribute("draggable","true"),e.dataset.primaryKey=i,e.classList.add("file-item"),e.addEventListener("dragstart",s=>{var o,r;e.focus(),(o=s.dataTransfer)==null||o.setData("primaryKey",i),(r=s.dataTransfer)==null||r.setData("dragtype","file-item")}),e.addEventListener("dblclick",async()=>{g.open("Loading file into your project... might take a while"),window.editor.myProject.insertNodeFromFile(t)}),e.addEventListener("contextmenu",s=>{s.preventDefault(),U.open([{title:"delete",cb:()=>{e.remove(),O(+i,t)}}],s.clientX,s.clientY)}),t.metadata.type.startsWith("audio/"))e.appendChild(b(z));else{const s=document.createElement("div");s.style.backgroundImage=`url(${t.metadata.thumbnail})`,s.style.backgroundSize="contain",s.style.backgroundRepeat="no-repeat",s.style.backgroundPosition="center",s.style.width="100%",s.style.height="100%",e.appendChild(s)}const l=document.createElement("span");l.classList.add("filename"),l.textContent=t.metadata.filename,e.appendChild(l),document.getElementById("file-list").appendChild(e)}async function O(t,i){try{g.open(`Deleting ${i.metadata.filename}...`),await Promise.all([...i.chunks.map(e=>F.deleteById(e)),P.deleteById(t)])}catch(e){console.error(e)}finally{g.close()}}async function V(t){if(g.open("Uploading your file... might take a while"),!t)throw new Error("File not found");const i=URL.createObjectURL(t);try{const e={filename:t.name,size:t.size,type:t.type};if(t.type.startsWith("video/")){const{duration:s,videoHeight:o,videoWidth:r,frame:a}=await window.editor.myProject.getVideoMetadataFromFile(i);e.duration=s,e.width=r,e.height=o,e.thumbnail=a}else if(t.type.startsWith("image/")){const{width:s,height:o,frame:r}=await window.editor.myProject.getImageMetadataFromFile(i);e.width=s,e.height=o,e.thumbnail=r}const n=await F.saveFile(t),l={metadata:e,chunks:n},{data:d}=await P.create(l);return{pk:d,data:l}}catch(e){console.error("errr",e)}finally{URL.revokeObjectURL(i),g.close()}}const q=async()=>{const t=document.getElementById("file-list");if(t&&t.children.length)return;const{data:i}=await P.findAll();Object.entries(i).forEach(([e,n])=>{n&&S(n,e)}),console.log("files from DB has loaded into panel")},_=N(),k=({name:t,width:i,height:e})=>`${t} (${i} x ${e} px)`,H=()=>{const t=document.createElement("div");t.setAttribute("id","setting-panel");const i=document.createElement("label");i.textContent="Project Dimension :",t.appendChild(i);const e=document.createElement("div");e.setAttribute("id","select-selected"),e.textContent="select project dimension",t.appendChild(e),window.editor.myProject&&(e.textContent=k(window.editor.myProject.presetSize()));const n=document.createElement("div");return n.setAttribute("id","select-items"),t.appendChild(n),Object.entries(W).forEach(([l,{icon:d,options:s}])=>{const o=document.createElement("div");o.classList.add("category"),o.textContent=l,o.appendChild(b(d)),n.appendChild(o),s.forEach(r=>{const a=document.createElement("div");a.classList.add("item"),a.setAttribute("id","item");const w=k(r);e.textContent===w&&a.classList.add("item-selected"),a.addEventListener("click",()=>{var x;a.classList.contains("item-selected")||((x=n.querySelector(".item-selected"))==null||x.classList.remove("item-selected"),a.classList.add("item-selected"),e.textContent=a.textContent,window.editor.myProject.presetSize(r))}),a.appendChild(b(r.icon));const y=document.createElement("span");y.textContent=w,a.appendChild(y),n.appendChild(a)})}),e.addEventListener("click",()=>{n.style.display=n.style.display==="block"?"none":"block"}),document.addEventListener("click",l=>{["select-selected","select-items","item"].includes(l.target.id)||(n.style.display="none")}),t},X=H(),Y=[{icon:M,text:"Uploads",body:_},{icon:$,text:"Settings",body:X}];var m,p,u,I,j,h;class Z{constructor(){f(this,u);v(this,"sidePanelDrawerElem");v(this,"panelWrapperElem");v(this,"panelCloseBtnElem");f(this,m);f(this,p);f(this,h,()=>{window.editor.myProject.recalculateCanvasSize(),this.sidePanelDrawerElem.removeEventListener("transitionend",c(this,h))});E(this,m,!1),this.sidePanelDrawerElem=document.getElementById("side-panel-drawer"),this.panelWrapperElem=document.getElementById("panel-wrapper"),this.panelCloseBtnElem=document.getElementById("side-panel-drawer-close"),C(this,u,I).call(this)}open(){E(this,m,!0),this.sidePanelDrawerElem.style.width="350px",this.sidePanelDrawerElem.addEventListener("transitionend",c(this,h))}close(){E(this,m,!1),this.sidePanelDrawerElem.style.width="0",this.sidePanelDrawerElem.addEventListener("transitionend",c(this,h))}toggle(i){i===c(this,p)?c(this,m)?this.close():this.open():this.open()}}m=new WeakMap,p=new WeakMap,u=new WeakSet,I=function(){Y.forEach((i,e)=>{const n=C(this,u,j).call(this,i,e);this.panelWrapperElem.appendChild(n)}),this.panelCloseBtnElem.addEventListener("click",()=>{this.close()})},j=function({icon:i,text:e,body:n},l){const d=document.createElement("button");d.classList.add("panel-item"),d.setAttribute("id",l.toString()),d.setAttribute("tabindex","0");const s=document.createElement("span");return s.innerText=e,d.appendChild(b(i)),d.appendChild(s),d.addEventListener("click",()=>{const o=this.sidePanelDrawerElem.querySelector("#body");for(const a of o.children)o.removeChild(a);const r=this.sidePanelDrawerElem.querySelector("#panel-title");r.innerText=d.innerText,n&&o.appendChild(n),this.toggle(+d.id),E(this,p,+d.id);for(const a of this.panelWrapperElem.children)c(this,p)===+a.id?a.classList.add("selected"):a.classList.remove("selected");e.toLowerCase()==="uploads"&&q()}),d},h=new WeakMap;new Z;
